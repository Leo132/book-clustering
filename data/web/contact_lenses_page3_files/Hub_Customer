(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof module!="undefined"&&module.exports?module.exports=n:n(jQuery,window,document)})(function(n,t){var i=n.connection.chatHub,r=[],u,f;i.client.broadcastMessage=function(){};i.client.receiveMessage=function(n){var t=this;f.receiveMessage(n)};customerHub=function(){var i=this;i.mediator=null;n.connection.hub.logging=!0;n.connection.hub.start().done(function(){});n.connection.hub.reconnecting(function(){});n.connection.hub.reconnected(function(){});n.connection.hub.disconnected(function(){});n.connection.hub.stateChanged(function(t){if(i.mediator.methods.common.public.chatconnect.connectstatechange(t.oldState,t.newState),t.newState===n.signalR.connectionState.connected)while(r.length){var u=r.shift();u()}});f={receiveMessage:function(n){i.mediator.methods.processor.receiveMessage(n)}};t.onbeforeunload=function(){i.mediator.methods.common.public.ignoreOnBeforeUnload.GetStatus()||(u=new i.mediator.methods.common.public.loading,u.start(),n.connection.hub.stop());i.mediator.methods.common.public.ignoreOnBeforeUnload.Unignore()}};customerHub.prototype={sendMessage:function(t,u){var e={strMessageType:t,Message:u},f;return n.connection.hub.state!==n.signalR.connectionState.connected||r.length?(f=n.Deferred(),r.push(function(){i.server.customerSendMessage(e).done(function(){f.resolve.apply(f,arguments)}).fail(function(){f.reject.apply(f,arguments)})}),f.promise()):i.server.customerSendMessage(e)},sendMessageObj:function(t){if(n.connection.hub.state!==n.signalR.connectionState.connected||r.length){var u=n.Deferred();return r.push(function(){i.server.customerSendMessage(t).done(function(){u.resolve.apply(u,arguments)}).fail(function(){u.reject.apply(u,arguments)})}),u.promise}return i.server.customerSendMessage(t)},reConnect:function(){return n.connection.hub.state===n.signalR.connectionState.disconnected?n.connection.hub.start().done(function(){u&&(u.over(),u=undefined)}):n.Deferred().resolve()}}})